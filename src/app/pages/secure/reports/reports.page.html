<ion-header class="products-header">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home"></ion-back-button>
    </ion-buttons>
    <ion-title>Reports</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="reports-content">

  <!-- Date Input -->
  <!-- <ion-item lines="none" class="date-input">
    <ion-icon name="calendar-outline" slot="start"></ion-icon>
    <ion-input 
  type="date"
  [(ngModel)]="date"
  (ionChange)="onDateChange()">
</ion-input> -->

  <!-- </ion-item> -->

  <!-- Top Tabs -->
  <ion-segment
    [(ngModel)]="activeTab"
    (ionChange)="onTabChange($event)"
    class="report-tabs">
    <ion-segment-button value="sales">Sales</ion-segment-button>
    <ion-segment-button value="shift">
  SALES PER Employee
</ion-segment-button>

    <!-- <ion-segment-button value="inventory">Inventory</ion-segment-button> -->
  </ion-segment>

  <!-- SALES -->
  <ng-container *ngIf="activeTab === 'sales'">

    <ion-card class="summary-card">
      <ion-card-content>
        <h3>Total Sales</h3>
        <h1>₹ {{ sales?.total_sales || 0 | number:'1.2-2' }}</h1>
      </ion-card-content>
    </ion-card>

     <!-- Sales Chart -->
    <ion-card>
  <ion-card-header class="chart-header">
    <div class="header-row">
      <ion-card-title>Sales Chart</ion-card-title>

      <div class="month-indicator" *ngIf="salesFilter !== 'daily'">
        <span class="dot"></span>
        <span class="month-text">{{ currentMonth }}</span>
      </div>
    </div>
  </ion-card-header>

  <ion-card-content>
    <div class="chart-container">
      <canvas #salesChart></canvas>
    </div>
  </ion-card-content>
</ion-card>


    <!-- Orders Chart -->
    <ion-card>
      <ion-card-header class="chart-header">
  <div class="header-row">
    <ion-card-title>Orders Chart</ion-card-title>

   

  </div>
</ion-card-header>



      <ion-card-content>
        <div class="chart-container">
          <canvas #ordersChart></canvas>
        </div>
      </ion-card-content>
    </ion-card>

   

  </ng-container>

 <!-- SHIFT -->
<ng-container *ngIf="activeTab === 'shift'">

  <ion-item lines="none" class="date-input">
    <ion-icon name="calendar-outline" slot="start"></ion-icon>
    <ion-input 
      type="date"
      [(ngModel)]="date"
      (ionChange)="onDateChange()">
    </ion-input>
  </ion-item>



  <!-- Summary -->
  <ion-card class="summary-card">
    <ion-card-content>
      <h3>Total Sales</h3>
      <h1>₹ {{ shiftData?.total_sales || 0 | number:'1.2-2' }}</h1>
      <p>Total Orders: {{ shiftData?.total_orders || 0 }}</p>
    </ion-card-content>
  </ion-card>

 <!-- Sales Per Shift -->
  <ion-card>
    <ion-card-header>
      <ion-card-title>Sales Per Employee</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <div class="chart-container">
        <canvas #shiftSalesChart></canvas>
      </div>
    </ion-card-content>
  </ion-card>

  <!-- Orders Per Shift -->
  <ion-card>
    <ion-card-header>
      <ion-card-title>Orders Per Employee</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <div class="chart-container">
        <canvas #shiftOrdersChart></canvas>
      </div>
    </ion-card-content>
  </ion-card>

 

</ng-container>

  <!-- INVENTORY -->
  <ng-container *ngIf="activeTab === 'inventory'">
    <ion-list>
      <ion-item *ngFor="let p of inventory">
        <ion-label>
          <strong>{{ p.product }}</strong>
          <p>
            Opening: {{ p.opening }} |
            Sold: {{ p.sold }} |
            Remaining: {{ p.remaining }}
          </p>
        </ion-label>
      </ion-item>
    </ion-list>
  </ng-container>

</ion-content>

<!-- ✅ REAL FOOTER (OUTSIDE ion-content) -->
<ion-footer *ngIf="activeTab === 'sales'">
  <ion-toolbar>
    <ion-segment
      [(ngModel)]="salesFilter"
      (ionChange)="loadSales()">

      <ion-segment-button value="daily">
        <ion-label>Daily</ion-label>
      </ion-segment-button>

      <ion-segment-button value="weekly">
        <ion-label>Weekly</ion-label>
      </ion-segment-button>

      <ion-segment-button value="monthly">
        <ion-label>Monthly</ion-label>
      </ion-segment-button>

    </ion-segment>
  </ion-toolbar>
</ion-footer>
